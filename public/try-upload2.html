<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<form name="form1" onsubmit="return checkForm()">

    <label for="avatar">大頭貼 </label>
    <input type="file" name="avatar" id="avatar"><br>

    <label for="name">姓名 </label>
    <input type="text" name="name" id="name"><br>

    <input type="submit">
    
</form>

<img src="" alt="" id="myImg">
<script>
    function checkForm(){
        const fd = new FormData(document.form1);
        fetch('/try-upload', {
            method: 'POST',
            body: fd, // enctype 預設為 multipart/form-data
        })
        .then(r=>r.json())
        .then(obj=>{
            console.log(obj);
            document.querySelector('#myImg').src = '/img/' + obj.newName;
        });
        return false;
    }
</script>

</body>
</html>